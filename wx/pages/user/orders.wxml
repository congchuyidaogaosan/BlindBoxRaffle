<!--pages/user/orders.wxml-->
<view class="container">
  <!-- 标签栏 -->
  <view class="tabs">
    <view 
      class="tab-item {{currentTab === index ? 'active' : ''}}"
      wx:for="{{tabs}}"
      wx:key="index"
      data-index="{{index}}"
      bindtap="onTabChange"
    >
      {{item}}
    </view>
  </view>

  <!-- 订单列表 -->
  <scroll-view 
    class="order-list"
    scroll-y
    enable-flex
    refresher-enabled
    bindrefresherrefresh="fetchOrders"
  >
    <view class="order-item" wx:for="{{orderList}}" wx:key="id">
      <view class="order-header">
        <text class="order-no">订单号：{{item.id}}</text>
        <text class="order-status {{getStatusClass(item.status)}}">
          {{getStatusText(item.status)}}
        </text>
      </view>

      <view class="order-content">
        <image 
          class="style-image" 
          src="{{item.boxStyle.imageUrl}}" 
          mode="aspectFill"
        />
        <view class="style-info">
          <text class="style-name">{{item.boxStyle.name}}</text>
          <text class="style-price">¥{{item.totalAmount}}</text>
        </view>
      </view>

      <view class="order-footer">
        <text class="order-time">{{item.createTime}}</text>
        <view class="order-actions">
          <button 
            class="cancel-btn"
            size="mini"
            wx:if="{{item.status === 'PENDING'}}"
            data-id="{{item.id}}"
            bindtap="handleCancel"
          >取消订单</button>
        </view>
      </view>
    </view>

    <!-- 加载状态 -->
    <view class="loading" wx:if="{{loading}}">加载中...</view>
    
    <!-- 空状态 -->
    <view class="empty" wx:if="{{!loading && orderList.length === 0}}">
      <text>暂无订单</text>
    </view>
  </scroll-view>
</view>